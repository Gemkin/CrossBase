// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 11.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace CrossBase.CodeGeneration.Templates
{
    using System.Collections.Generic;
    using Language;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "11.0.0.0")]
    public partial class DispatchProxyTemplate : Templates.TemplateBase
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            this.Write("\r\n");
            return this.GenerationEnvironment.ToString();
        }
        
        #line 5 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

    public string ClassName;
	public string ProxyName;
	public string InterfaceName;
	public string ProxyNamespace;
	public List<string> CustomDefaultNamespaces;
	private string attributeName;

	public override void Render()
	{
		debugOutput = string.Empty;
		attributeName = "DispatchProxy";
		var classes = Parser.GetAllClassesThatHaveAnAttribute(attributeName);

		foreach (var @class in classes)
		{
			foreach(var attribute in @class.Attributes)
			{
				if (attribute.Name != attributeName)
					continue; 

				ProxyName = @class.Name;
				ProxyNamespace = @class.Namespace.Name;
				InterfaceName = attribute.GetArgument("InterfaceName");
				ClassName = attribute.GetArgument("ClassName");
				
				var fileName = attribute.FileName;
				var projectItem = Parser.GetProjectItem(fileName);
				var outputFileName = fileName.Replace(".cs", "." + InterfaceName + "." + attributeName + ".g.cs");

				if (string.IsNullOrEmpty(InterfaceName))
				{
					debugOutput += string.Format("InterfaceName not set on " + attributeName + " attribute on class {0}\r\n", @class.Name);		
					continue;
				}

				var @interface = Parser.Interfaces.Find(f=> f.Name == InterfaceName);
				if (@interface == null)
				{
					debugOutput += string.Format("Interface {1} not found " + attributeName + " attribute on class {0}\r\n", @class.Name, InterfaceName);		
					continue;
				}

				var useDefaultRule = false;
				if (string.IsNullOrEmpty(ClassName))
				{
					debugOutput += string.Format("ClassName to proxy not set on " + attributeName + " attribute on class {0}, using default name derived from interface name\r\n", @class.Name);
					useDefaultRule = true;
				}


				var fieldName =  useDefaultRule ? @interface.GetDefaultPrivateFieldName() : ClassName.ChangeFirstChar(ChangeCase.ToLower);
				var propertyName = useDefaultRule? @interface.GetDefaultPropertyName() : ClassName;


				var containsNotifyPropertyChanged = @interface.AllEvents.Exists(s => s.Name == "PropertyChanged");

				GenerateHeader();
				var usings = new List<string>
					{
						"System",
						"CrossBase.Dispatch",
					};
				if (containsNotifyPropertyChanged)
					usings.Add("System.ComponentModel");
				GenerateUsings(@class, usings);

        
        #line default
        #line hidden
        
        #line 71 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("using ");

        
        #line default
        #line hidden
        
        #line 72 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(@interface.Namespace.Name));

        
        #line default
        #line hidden
        
        #line 72 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\r\nnamespace ");

        
        #line default
        #line hidden
        
        #line 74 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(ProxyNamespace));

        
        #line default
        #line hidden
        
        #line 74 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\r\n{\r\n\tpublic interface I");

        
        #line default
        #line hidden
        
        #line 76 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(ProxyName));

        
        #line default
        #line hidden
        
        #line 76 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" \r\n\t{\r\n\t\t");

        
        #line default
        #line hidden
        
        #line 78 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(@interface.Name));

        
        #line default
        #line hidden
        
        #line 78 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 78 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));

        
        #line default
        #line hidden
        
        #line 78 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" { get; set; }\r\n\t\tIDispatcher UpDispatcher { get; set; }\r\n\t\tIDispatcher DownDispa" +
        "tcher { get; set; }\r\n\r\n");

        
        #line default
        #line hidden
        
        #line 82 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"


				foreach (var evnt in @interface.AllEvents)
				{
        
        #line default
        #line hidden
        
        #line 85 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tevent ");

        
        #line default
        #line hidden
        
        #line 86 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Type));

        
        #line default
        #line hidden
        
        #line 86 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 86 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 86 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n");

        
        #line default
        #line hidden
        
        #line 87 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}

				var generatedFunctions = new List<string>();
				foreach (var function in @interface.AllFunctions)
				{
					if (generatedFunctions.Contains(function.Name))
						continue;
					generatedFunctions.Add(function.Name);
				
        
        #line default
        #line hidden
        
        #line 96 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tevent EventHandler<EventArgs> ");

        
        #line default
        #line hidden
        
        #line 97 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 97 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Started;\r\n\t\tevent EventHandler<EventArgs> ");

        
        #line default
        #line hidden
        
        #line 98 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 98 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Finished;\r\n");

        
        #line default
        #line hidden
        
        #line 99 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

					generatedFunctions.Add(function.Name);
				}

				foreach (var prop in @interface.AllProperties)
				{ 
        
        #line default
        #line hidden
        
        #line 104 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t");

        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Type));

        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Invoke { get; ");

        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
 if (prop.HasSetter) { 
        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" set; ");

        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
 } 
        
        #line default
        #line hidden
        
        #line 105 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" } \r\n");

        
        #line default
        #line hidden
        
        #line 106 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

					if (containsNotifyPropertyChanged)
					{
        
        #line default
        #line hidden
        
        #line 108 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t");

        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Type));

        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("BeginInvoke { get; ");

        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
 if (prop.HasSetter) { 
        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" set; ");

        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
 } 
        
        #line default
        #line hidden
        
        #line 109 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" } \r\n");

        
        #line default
        #line hidden
        
        #line 110 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

					}
				}

				foreach (var func in @interface.AllFunctions)
				{ 
					if (func.Type == "void")
					{
        
        #line default
        #line hidden
        
        #line 117 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t");

        
        #line default
        #line hidden
        
        #line 118 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(func.InterfaceSignature()));

        
        #line default
        #line hidden
        
        #line 118 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n");

        
        #line default
        #line hidden
        
        #line 119 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

					}
        
        #line default
        #line hidden
        
        #line 120 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t");

        
        #line default
        #line hidden
        
        #line 121 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(func.InterfaceSignature(string.Empty, "Invoke")));

        
        #line default
        #line hidden
        
        #line 121 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n");

        
        #line default
        #line hidden
        
        #line 122 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}

        
        #line default
        #line hidden
        
        #line 124 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t}\r\n\r\n\tpublic partial class ");

        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(ProxyName));

        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(": I");

        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(ProxyName));

        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
 if (containsNotifyPropertyChanged){
        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(", INotifyPropertyChanged");

        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
}
        
        #line default
        #line hidden
        
        #line 127 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(@"
	{
		protected T GetCloneIfPossible<T>(T obj)
		{
			Object x = obj;
 
			if (x is ICloneable)
			{
				var cloneable = (object) x as ICloneable;
				x = cloneable.Clone();
			}
			return (T)x;
		}

		public IDispatcher UpDispatcher { get; set; }
		public IDispatcher DownDispatcher { get; set; }

");

        
        #line default
        #line hidden
        
        #line 145 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
				foreach (var evnt in @interface.AllEvents)
				{
        
        #line default
        #line hidden
        
        #line 146 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tpublic event ");

        
        #line default
        #line hidden
        
        #line 147 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Type));

        
        #line default
        #line hidden
        
        #line 147 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 147 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 147 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n");

        
        #line default
        #line hidden
        
        #line 148 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}

        
        #line default
        #line hidden
        
        #line 153 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				foreach (var prop in @interface.AllProperties)
				{ 
					if (containsNotifyPropertyChanged)
					{

        
        #line default
        #line hidden
        
        #line 158 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tprivate ");

        
        #line default
        #line hidden
        
        #line 159 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Type));

        
        #line default
        #line hidden
        
        #line 159 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 159 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.GetDefaultPrivateFieldName()));

        
        #line default
        #line hidden
        
        #line 159 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("BeginInvoke;\r\n\t\tpublic ");

        
        #line default
        #line hidden
        
        #line 160 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Type));

        
        #line default
        #line hidden
        
        #line 160 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 160 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 160 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("BeginInvoke \r\n\t\t{\r\n\t\t\tget\r\n\t\t\t{\r\n\t\t\t\treturn ");

        
        #line default
        #line hidden
        
        #line 164 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.GetDefaultPrivateFieldName()));

        
        #line default
        #line hidden
        
        #line 164 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 166 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				if (prop.HasSetter)
				{

        
        #line default
        #line hidden
        
        #line 169 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t\tset\r\n\t\t\t{\r\n\t\t\t\tvalue = GetCloneIfPossible(value);\r\n\t\t\t\tDownDispatcher.BeginInv" +
        "oke(() => \r\n\t\t\t\t{\r\n\t\t\t\t\tif (value == ");

        
        #line default
        #line hidden
        
        #line 175 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 175 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 175 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 175 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(")\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t");

        
        #line default
        #line hidden
        
        #line 177 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 177 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 177 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 177 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" = value; \r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 181 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}

        
        #line default
        #line hidden
        
        #line 183 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 185 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				    }
					else
					{
        
        #line default
        #line hidden
        
        #line 188 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tprivate ");

        
        #line default
        #line hidden
        
        #line 189 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Type));

        
        #line default
        #line hidden
        
        #line 189 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 189 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.GetDefaultPrivateFieldName()));

        
        #line default
        #line hidden
        
        #line 189 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Invoke;\r\n\r\n\t\tpublic ");

        
        #line default
        #line hidden
        
        #line 191 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Type));

        
        #line default
        #line hidden
        
        #line 191 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 191 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 191 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Invoke \r\n\t\t{\r\n\t\t\tget\r\n\t\t\t{\r\n\t\t\t\tException exception = null;\r\n\t\t\t\tvar value = ");

        
        #line default
        #line hidden
        
        #line 196 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.GetDefaultPrivateFieldName()));

        
        #line default
        #line hidden
        
        #line 196 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Invoke;\r\n\t\t\t\tDownDispatcher.Invoke(() => \r\n\t\t\t\t{\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalue =" +
        " ");

        
        #line default
        #line hidden
        
        #line 201 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 201 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 201 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 201 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t\t\t\tvalue = GetCloneIfPossible(value);\t\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (Except" +
        "ion ex)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\texception = ex;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (exception != nu" +
        "ll)\r\n\t\t\t\t\tthrow exception;\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 213 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				if (prop.HasSetter)
				{

        
        #line default
        #line hidden
        
        #line 216 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t\tset\r\n\t\t\t{\r\n\t\t\t\tException exception = null;\r\n\t\t\t\tvalue = GetCloneIfPossible(val" +
        "ue);\r\n\t\t\t\tDownDispatcher.Invoke(() => \r\n\t\t\t\t{\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (value" +
        " == ");

        
        #line default
        #line hidden
        
        #line 225 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 225 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 225 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 225 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(")\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t");

        
        #line default
        #line hidden
        
        #line 227 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 227 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 227 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(prop.Name));

        
        #line default
        #line hidden
        
        #line 227 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" = value; \r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (Exception ex)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\texception = ex;\r\n\t\t\t" +
        "\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (exception != null)\r\n\t\t\t\t\tthrow exception;\r\n\t\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 238 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}

        
        #line default
        #line hidden
        
        #line 240 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 242 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
					}
				}
				generatedFunctions.Clear();
				foreach (var function in @interface.AllFunctions)
				{
					if (generatedFunctions.Contains(function.Name))
						continue;
					generatedFunctions.Add(function.Name);

				
        
        #line default
        #line hidden
        
        #line 251 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\r\n\t\tpublic event EventHandler<EventArgs> ");

        
        #line default
        #line hidden
        
        #line 253 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 253 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Started;\r\n\t\tpublic event EventHandler<EventArgs> ");

        
        #line default
        #line hidden
        
        #line 254 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 254 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Finished;\r\n\t\t\r\n\t\tprivate void Invoke");

        
        #line default
        #line hidden
        
        #line 256 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 256 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Started(EventArgs e)\r\n\t\t{\r\n\t\tvar handler = ");

        
        #line default
        #line hidden
        
        #line 258 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 258 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Started;\r\n\t\tif (handler != null) handler(this, e);\r\n\t\t}\r\n\r\n\t\tprivate void Invoke");

        
        #line default
        #line hidden
        
        #line 262 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 262 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Finished(EventArgs e)\r\n\t\t{\r\n\t\t\tvar handler = ");

        
        #line default
        #line hidden
        
        #line 264 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 264 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Finished;\r\n\t\t\tif (handler != null) handler(this, e);\r\n\t\t}\r\n\t\t");

        
        #line default
        #line hidden
        
        #line 267 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}
				
        
        #line default
        #line hidden
        
        #line 269 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tprivate  ");

        
        #line default
        #line hidden
        
        #line 270 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(@interface.Name));

        
        #line default
        #line hidden
        
        #line 270 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 270 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 270 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\r\n\t\tpublic ");

        
        #line default
        #line hidden
        
        #line 272 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(@interface.Name));

        
        #line default
        #line hidden
        
        #line 272 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 272 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));

        
        #line default
        #line hidden
        
        #line 272 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\r\n\t\t{\r\n\t\t\tget\r\n\t\t\t{\r\n\t\t\t\treturn ");

        
        #line default
        #line hidden
        
        #line 276 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 276 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t}\r\n\t\t\tset\r\n\t\t\t{\t\t\t\r\n\t\t\t\tif (");

        
        #line default
        #line hidden
        
        #line 280 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 280 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" != null) \r\n\t\t\t\t\tUnsubscribeTo");

        
        #line default
        #line hidden
        
        #line 281 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));

        
        #line default
        #line hidden
        
        #line 281 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("();\r\n\r\n\t\t\t\t");

        
        #line default
        #line hidden
        
        #line 283 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 283 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" = value;\r\n\t\t\t\tSubscribeTo");

        
        #line default
        #line hidden
        
        #line 284 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));

        
        #line default
        #line hidden
        
        #line 284 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("();\r\n\t\t\t}\r\n\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 287 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				foreach (var evnt in @interface.AllEvents)
				{
					if (evnt.Name == "PropertyChanged")
					{

        
        #line default
        #line hidden
        
        #line 292 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tprivate void On");

        
        #line default
        #line hidden
        
        #line 293 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 293 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Handler(object sender, PropertyChangedEventArgs e)\r\n\t\t{\r\n\t\t\tswitch (e.PropertyNam" +
        "e)\r\n\t\t\t{\r\n");

        
        #line default
        #line hidden
        
        #line 297 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

						foreach (var property in @interface.AllProperties)
						{

        
        #line default
        #line hidden
        
        #line 300 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t\t\tcase \"");

        
        #line default
        #line hidden
        
        #line 301 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(property.Name));

        
        #line default
        #line hidden
        
        #line 301 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\":\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar propClone = ");

        
        #line default
        #line hidden
        
        #line 303 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 303 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 303 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(property.Name));

        
        #line default
        #line hidden
        
        #line 303 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t\t\t\tpropClone = GetCloneIfPossible(propClone);\r\n\t\t\t\t\t\tUpDispatcher.BeginInvo" +
        "ke(() =>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t");

        
        #line default
        #line hidden
        
        #line 307 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(property.GetDefaultPrivateFieldName()));

        
        #line default
        #line hidden
        
        #line 307 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" = propClone;\r\n\t\t\t\t\t\t\t\tvar handler = PropertyChanged;\r\n\t\t\t\t\t\t\t\tif (handler != nul" +
        "l) handler(this, new PropertyChangedEventArgs(e.PropertyName));\r\n\t\t\t\t\t\t\t});\r\n\r\n\t" +
        "\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 314 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

						}

        
        #line default
        #line hidden
        
        #line 316 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\r\n");

        
        #line default
        #line hidden
        
        #line 321 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

						
					}
					else
					{

        
        #line default
        #line hidden
        
        #line 326 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tprivate void On");

        
        #line default
        #line hidden
        
        #line 327 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 327 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Handler(object sender, ");

        
        #line default
        #line hidden
        
        #line 327 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.GenericEventHandlerType));

        
        #line default
        #line hidden
        
        #line 327 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" e)\r\n\t\t{\r\n\t\t\tvar eventArgs = e;\r\n\t\t\teventArgs = GetCloneIfPossible(eventArgs);\r\n\t" +
        "\t\tUpDispatcher.BeginInvoke(() =>\r\n\t\t\t\t{\r\n\t\t\t\t\tvar handler = ");

        
        #line default
        #line hidden
        
        #line 333 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 333 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t\t\tif (handler != null) handler(this, eventArgs);\r\n\t\t\t\t});\r\n\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 337 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

					}
				}

        
        #line default
        #line hidden
        
        #line 340 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\tpublic void UnsubscribeTo");

        
        #line default
        #line hidden
        
        #line 341 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));

        
        #line default
        #line hidden
        
        #line 341 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("()\r\n\t\t{\r\n\t\t\tif (");

        
        #line default
        #line hidden
        
        #line 343 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 343 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" == null)\r\n\t\t\t\treturn;\r\n");

        
        #line default
        #line hidden
        
        #line 345 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				foreach (var evnt in @interface.AllEvents)
				{

        
        #line default
        #line hidden
        
        #line 348 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t\t");

        
        #line default
        #line hidden
        
        #line 349 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 349 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 349 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 349 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" -= On");

        
        #line default
        #line hidden
        
        #line 349 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 349 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Handler;\r\n");

        
        #line default
        #line hidden
        
        #line 350 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}
		
        
        #line default
        #line hidden
        
        #line 352 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t}\t\t\r\n\r\n\t\tprivate void SubscribeTo");

        
        #line default
        #line hidden
        
        #line 355 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(propertyName));

        
        #line default
        #line hidden
        
        #line 355 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("()\r\n\t\t{\r\n");

        
        #line default
        #line hidden
        
        #line 357 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				foreach (var evnt in @interface.AllEvents)
				{

        
        #line default
        #line hidden
        
        #line 360 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t\t");

        
        #line default
        #line hidden
        
        #line 361 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 361 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 361 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 361 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" += On");

        
        #line default
        #line hidden
        
        #line 361 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(evnt.Name));

        
        #line default
        #line hidden
        
        #line 361 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Handler;\r\n");

        
        #line default
        #line hidden
        
        #line 362 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				}
		
        
        #line default
        #line hidden
        
        #line 364 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t}\r\n\r\n");

        
        #line default
        #line hidden
        
        #line 367 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				foreach (var function in @interface.AllFunctions)
				{
					if (function.Type == "void") 
					{
        
        #line default
        #line hidden
        
        #line 371 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t");

        
        #line default
        #line hidden
        
        #line 372 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Signature()));

        
        #line default
        #line hidden
        
        #line 372 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\r\n\t\t{\r\n\t\t\tDownDispatcher.BeginInvoke(() => \r\n\t\t\t\t{\r\n\t\t\t\t\tUpDispatcher.BeginInvoke" +
        "(() => Invoke");

        
        #line default
        #line hidden
        
        #line 376 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 376 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Started(EventArgs.Empty));\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t");

        
        #line default
        #line hidden
        
        #line 379 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 379 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 379 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.CallSignature("")));

        
        #line default
        #line hidden
        
        #line 379 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfinally\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tUpDispatcher.BeginInvoke(() => Invoke");

        
        #line default
        #line hidden
        
        #line 383 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 383 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Finished(EventArgs.Empty));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 387 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
					}
					if (function.Type != "void")
					{ 
        
        #line default
        #line hidden
        
        #line 389 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t");

        
        #line default
        #line hidden
        
        #line 390 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Type));

        
        #line default
        #line hidden
        
        #line 390 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(" ");

        
        #line default
        #line hidden
        
        #line 390 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 390 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Dummy;\r\n\t\t");

        
        #line default
        #line hidden
        
        #line 391 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Signature("", "Invoke")));

        
        #line default
        #line hidden
        
        #line 391 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\r\n\t\t{\r\n\t\t\tvar result = ");

        
        #line default
        #line hidden
        
        #line 393 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 393 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Dummy;\r\n\t\t\tException exception = null;\r\n\t\t\tDownDispatcher.Invoke(() => \r\n\t\t\t\t{\r\n\t" +
        "\t\t\t\tInvoke");

        
        #line default
        #line hidden
        
        #line 397 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 397 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Started(EventArgs.Empty);\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tresult = ");

        
        #line default
        #line hidden
        
        #line 400 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 400 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 400 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.CallSignature("")));

        
        #line default
        #line hidden
        
        #line 400 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch(Exception ex)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\texception = ex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t" +
        "finally\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tInvoke");

        
        #line default
        #line hidden
        
        #line 408 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 408 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Finished(EventArgs.Empty);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\tif (exception != null)\r\n\t\t\t\tthrow" +
        " exception;\r\n\t\t\treturn result;\r\n\t\t}\r\n");

        
        #line default
        #line hidden
        
        #line 415 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
					}
					else
					{
        
        #line default
        #line hidden
        
        #line 417 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t\t");

        
        #line default
        #line hidden
        
        #line 418 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Signature("", "Invoke")));

        
        #line default
        #line hidden
        
        #line 418 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\r\n\t\t{\r\n\t\t\tException exception = null;\r\n\t\t\t\r\n\t\t\tDownDispatcher.Invoke(() => \r\n\t\t\t\t" +
        "{\r\n\t\t\t\t\tInvoke");

        
        #line default
        #line hidden
        
        #line 424 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 424 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Started(EventArgs.Empty);\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t");

        
        #line default
        #line hidden
        
        #line 427 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(fieldName));

        
        #line default
        #line hidden
        
        #line 427 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 427 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.CallSignature("")));

        
        #line default
        #line hidden
        
        #line 427 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch(Exception ex)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\texception = ex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t" +
        "finally\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tInvoke");

        
        #line default
        #line hidden
        
        #line 435 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(function.Name));

        
        #line default
        #line hidden
        
        #line 435 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("Finished(EventArgs.Empty);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\tif (exception != null)\r\n\t\t\t\tthrow" +
        " exception;\r\n\t\t}\r\n\r\n");

        
        #line default
        #line hidden
        
        #line 442 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
					}
				}
        
        #line default
        #line hidden
        
        #line 443 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"
this.Write("\t}\r\n}\r\n\r\n");

        
        #line default
        #line hidden
        
        #line 447 "E:\Development\Crossbase\CrossBase.CodeGeneration\Templates\DispatchProxyTemplate.tt"

				GenerateFooter();
				debugOutput += string.Format("Generated {0}\r\n", outputFileName);
				Delete(projectItem, outputFileName);
				Save(projectItem, outputFileName);
			}
		}
		base.Render();
	}


        
        #line default
        #line hidden
    }
    
    #line default
    #line hidden
}
